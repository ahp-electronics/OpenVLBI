<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Open source Very Long Baseline Interferometry: Build libvlbi</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Open source Very Long Baseline Interferometry
   </div>
   <div id="projectbrief">OpenVLBI</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Build libvlbi </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="fragment"><div class="line">sh scripts/build.sh</div>
</div><!-- fragment --><p>You can read the API documentation at <a href="https://iliaplatone.github.io/OpenVLBI/api/">https://iliaplatone.github.io/OpenVLBI/api/</a></p>
<p>You can write an application using libvlbi by linking against libvlbi.so in your gcc command line: </p><div class="fragment"><div class="line">gcc yourapp.c -lvlbi -o yourapp</div>
</div><!-- fragment --><p>Each instance of vlbi is initiated by <a class="el" href="vlbi_8h.html#a7af54a4c1922c260e74c8a5f2fcb89d9" title="Initialize a libVLBI instance.">vlbi_init()</a>: </p><div class="fragment"><div class="line"><a class="code" href="vlbi_8h.html#a50f883f7e834b395856676739fe83e0e">vlbi_context</a> context = <a class="code" href="vlbi_8h.html#a7af54a4c1922c260e74c8a5f2fcb89d9">vlbi_init</a>();</div>
<div class="line"> </div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line">dsp_stream_p stream1 = <a class="code" href="dsp_8h.html#ac1a4e2f023ac686cb930e6b45a5b720d">dsp_stream_new</a>();</div>
<div class="line"><a class="code" href="dsp_8h.html#ab01d4c42bda4b0b9fe736fc74da3e79d">dsp_stream_add_dim</a>(stream, elements_n);</div>
<div class="line">dsp_convert(input_arr, stream1-&gt;in, n_elements);</div>
<div class="line"> </div>
<div class="line">stream1-&gt;location[0] = Latitude;</div>
<div class="line">stream1-&gt;location[1] = Longitude;</div>
<div class="line">stream1-&gt;location[2] = vlbi_calc_elevation_coarse(Elevation); <span class="comment">//estimate the geocentric elevation, given the on sea level elevation</span></div>
<div class="line"> </div>
<div class="line">stream1-&gt;starttimeutc = <a class="code" href="vlbi_8h.html#abc137a0b360978e3bef523914f84b619">vlbi_time_string_to_utc</a>(<span class="stringliteral">&quot;2018-06-22T02:12.000154874&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><a class="code" href="vlbi_8h.html#a4a75de84b2e783d4e374210b71718ed6">vlbi_add_stream</a>(context, stream1);</div>
<div class="line"> </div>
<div class="line"><a class="code" href="structdsp__stream__t.html">dsp_stream_p</a> stream2 = <a class="code" href="dsp_8h.html#ac1a4e2f023ac686cb930e6b45a5b720d">dsp_stream_new</a>();</div>
<div class="line"> </div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line">vlbi_add_stream(context, stream2);</div>
<div class="line"> </div>
<div class="line"><a class="code" href="structdsp__stream__t.html">dsp_stream_p</a> stream3 = <a class="code" href="dsp_8h.html#ac1a4e2f023ac686cb930e6b45a5b720d">dsp_stream_new</a>();</div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line">vlbi_add_stream(context, stream3);</div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line">dsp_t* target = calloc(<span class="keyword">sizeof</span>(vlbi_t), 3);</div>
<div class="line">target[0] = RightAscension * 360.0 / 24.0;</div>
<div class="line">target[1] = Declination;</div>
<div class="line"> </div>
<div class="line">dsp_t frequency = 60.0e+6;</div>
<div class="line">dsp_t samplerate = 100.0e+6;</div>
<div class="line"> </div>
<div class="line"><span class="comment">//obtain the UV plot of the observation</span></div>
<div class="line"><a class="code" href="structdsp__stream__t.html">dsp_stream</a> uvplot = <a class="code" href="vlbi_8h.html#ad59665f85f57dda9ef49bb5c88f6fca4">vlbi_get_uv_plot_aperture_synthesis</a>(context, u, v, target, frequency, samplerate); <span class="comment">// this will return</span></div>
<div class="line"><span class="comment">//the aproximate Fourier transform of the observation taken (the more are the streams, and more</span></div>
<div class="line"><span class="comment">//accurate and precise is each stream and data, the less aproximate will be the result).</span></div>
<div class="line"><a class="code" href="structdsp__stream__t.html">dsp_stream</a> image_estimation = <a class="code" href="vlbi_8h.html#a171f79cc83a4cbd4f1f00ed7d86d6b5a">vlbi_get_fft_estimate</a>(uvplot); <span class="comment">// this is the aproximation</span></div>
<div class="line"><span class="comment">//of the image of the target, with aproximation basis the taken observations.</span></div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line">dsp_stream_free(uvplot);</div>
<div class="line"><a class="code" href="vlbi_8h.html#a32534f7714c02277cd0eb519022f1c6f">vlbi_exit</a>(context);</div>
</div><!-- fragment --><p>OpenVLBI can be tested using the built vlbi_client_dummy application, which creates a subshell or takes arguments from the standard input. the source files of the sample application make use of the vlbi_client.h source header, which contains a base class to be inherited in case you want to build your own client or implementation. the sample application can be tested using the test.sh script into the scripts/ directory of this repository: the command-line usage is as follows: bash scripts/test.sh [integration time in seconds] [type of plot] where [type of plot] is: [geo|abs]_[movingbase|synthesis]_[raw|dft]</p>
<div class="fragment"><div class="line">bash scripts/test.sh 3600 geo_synthesis_dft</div>
</div><!-- fragment --><p>OpenVLBI comes with an application which uses the core library and using an INDI server which contains a number of drivers with the necessary properties It needs an indi server on which to connect. Such server must connect to each node to be added to the vlbi client application. OpenVLBI nodes must contain informations about location, and should permit driving of the telescopes or antennas to the same celestial coordinates, tracking must be supported on the mountings and each node should capture and run at the same bit depth, frequency and possibly bandwidth and gain.</p>
<p>The needed INDI interfaces are so:</p><ul>
<li>INDI::BaseDevice::TELESCOPE_INTERFACE</li>
<li>INDI::BaseDevice::GPS_INTERFACE</li>
<li>INDI::BaseDevice::DETECTOR_INTERFACE</li>
</ul>
<p>and optionally, also for autoguiding:</p><ul>
<li>INDI::BaseDevice::CCD_INTERFACE</li>
<li>INDI::BaseDevice::GUIDER_INTERFACE</li>
</ul>
<p>The properties used by this client are:</p><ul>
<li>"EQUATORIAL_EOD_COORDS" RA and DEC from telescope for gotos and slews</li>
<li>"TELESCOPE_TRACK_STATE" from telescope for tracking</li>
<li>"GEOGRAPHIC_COORDS" LATITUDE, LONGITUDE and ELEVATION to fill the UV plane and plot the frequency response</li>
<li>"DETECTOR_CAPTURE" to start capture</li>
<li>"DETECTOR_SETTINGS" set up frequency, bandwidth, sampling rate and depth, and gain of the detectors</li>
</ul>
<p>The vlbi client applications open a command shell and read from stdin. Format of commands is: cmd arg value:type where type can be string or numeric.</p>
<p>Here is the current command list:</p>
<div class="fragment"><div class="line">add context name:<span class="keywordtype">string</span> - add an OpenVLBI context to the <span class="keyword">internal</span> list</div>
<div class="line">set context name:<span class="keywordtype">string</span> - set current OpenVLBI context selecting it by name from the <span class="keyword">internal</span> list</div>
<div class="line">add node name,latitude,longitude,elevation,datafile,observationdate:<span class="keywordtype">string</span> - add a node to the <span class="keyword">internal</span> list</div>
<div class="line">del node name:<span class="keywordtype">string</span> - remove a node from the <span class="keyword">internal</span> list</div>
<div class="line">set model name:<span class="keywordtype">string</span> - <span class="keyword">new</span> comparison model</div>
<div class="line">set freq value:numeric - set detectors frequency</div>
<div class="line">set bitspersample value:numeric - set detectors sample bit depth</div>
<div class="line">set samplerate value:numeric - set detectors sampling rate</div>
<div class="line">set target ra,dec:numeric,numeric - set telescopes celestial target</div>
<div class="line">get observation type:<span class="keywordtype">string</span> - get UV plot observation ([geo|xyz]_[synthesis|movingbase]_[raw|dft|coverage]) <span class="keywordflow">for</span> aperture synthesis observation or to plot the UV coverage</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="adsp_8h_html_ac1a4e2f023ac686cb930e6b45a5b720d"><div class="ttname"><a href="dsp_8h.html#ac1a4e2f023ac686cb930e6b45a5b720d">dsp_stream_new</a></div><div class="ttdeci">DLL_EXPORT dsp_stream_p dsp_stream_new()</div><div class="ttdoc">Allocate a new DSP stream type.</div></div>
<div class="ttc" id="avlbi_8h_html_a4a75de84b2e783d4e374210b71718ed6"><div class="ttname"><a href="vlbi_8h.html#a4a75de84b2e783d4e374210b71718ed6">vlbi_add_stream</a></div><div class="ttdeci">DLL_EXPORT void vlbi_add_stream(vlbi_context ctx, dsp_stream_p Stream, char *name)</div><div class="ttdoc">Add a stream into the current libVLBI context.</div></div>
<div class="ttc" id="astructdsp__stream__t_html"><div class="ttname"><a href="structdsp__stream__t.html">dsp_stream_t</a></div><div class="ttdoc">Contains a set of informations and data relative to a buffer and how to use it.</div><div class="ttdef"><b>Definition:</b> dsp.h:141</div></div>
<div class="ttc" id="avlbi_8h_html_a7af54a4c1922c260e74c8a5f2fcb89d9"><div class="ttname"><a href="vlbi_8h.html#a7af54a4c1922c260e74c8a5f2fcb89d9">vlbi_init</a></div><div class="ttdeci">DLL_EXPORT vlbi_context vlbi_init()</div><div class="ttdoc">Initialize a libVLBI instance.</div></div>
<div class="ttc" id="avlbi_8h_html_a171f79cc83a4cbd4f1f00ed7d86d6b5a"><div class="ttname"><a href="vlbi_8h.html#a171f79cc83a4cbd4f1f00ed7d86d6b5a">vlbi_get_fft_estimate</a></div><div class="ttdeci">DLL_EXPORT dsp_stream_p vlbi_get_fft_estimate(dsp_stream_p uv)</div><div class="ttdoc">Plot a fourier transform of the object observed using an arbitrary positional buffer on each stream.</div></div>
<div class="ttc" id="avlbi_8h_html_a32534f7714c02277cd0eb519022f1c6f"><div class="ttname"><a href="vlbi_8h.html#a32534f7714c02277cd0eb519022f1c6f">vlbi_exit</a></div><div class="ttdeci">DLL_EXPORT void vlbi_exit(vlbi_context ctx)</div><div class="ttdoc">Close a libVLBI instance.</div></div>
<div class="ttc" id="avlbi_8h_html_a50f883f7e834b395856676739fe83e0e"><div class="ttname"><a href="vlbi_8h.html#a50f883f7e834b395856676739fe83e0e">vlbi_context</a></div><div class="ttdeci">void * vlbi_context</div><div class="ttdef"><b>Definition:</b> vlbi.h:227</div></div>
<div class="ttc" id="avlbi_8h_html_abc137a0b360978e3bef523914f84b619"><div class="ttname"><a href="vlbi_8h.html#abc137a0b360978e3bef523914f84b619">vlbi_time_string_to_utc</a></div><div class="ttdeci">DLL_EXPORT timespec_t vlbi_time_string_to_utc(char *time)</div><div class="ttdoc">obtain a timespec struct containing the date and time specified by a time string</div></div>
<div class="ttc" id="adsp_8h_html_ab01d4c42bda4b0b9fe736fc74da3e79d"><div class="ttname"><a href="dsp_8h.html#ab01d4c42bda4b0b9fe736fc74da3e79d">dsp_stream_add_dim</a></div><div class="ttdeci">DLL_EXPORT void dsp_stream_add_dim(dsp_stream_p stream, int len)</div><div class="ttdoc">Add a dimension with length len to a DSP stream.</div></div>
<div class="ttc" id="avlbi_8h_html_ad59665f85f57dda9ef49bb5c88f6fca4"><div class="ttname"><a href="vlbi_8h.html#ad59665f85f57dda9ef49bb5c88f6fca4">vlbi_get_uv_plot_aperture_synthesis</a></div><div class="ttdeci">DLL_EXPORT dsp_stream_p vlbi_get_uv_plot_aperture_synthesis(void *ctx, int m, int u, int v, double *target, double freq, double sr)</div><div class="ttdoc">Plot a fourier transform of the object observed using celestial coordinates and the integration times...</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Feb 19 2021 12:05:50 for Open source Very Long Baseline Interferometry by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
